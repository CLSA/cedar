{##
 # test_entry_alpha_numeric_adjudicate.twig
 # 
 # Adjudicate an alpha_numeric type test.
 # @author Dean Inglis <inglisd@mcmaster.ca>
 # @see base_view.twig for parameters
 #}
{% extends "widget.twig" %}

{% block javascript %}
  {{ parent() }}
  <script type="text/javascript">

    function configure_ui() {
      var disable = $( 'input:radio[value="accept"]:checked' ).length == 
                    $( 'input:radio[value="accept"]' ).length ? 0 : 1;    
      $("#{{ parent.full }}_Submit").button( { disabled : disable } );        
    }

    $( function () {

      configure_ui();

      $( "#{{ widget.full }}__entry_table" ).find( "input:text" ).change( function() {
        var args = new Object();
        var columns = new Object();
        columns["id"] = $(this).attr("id").split("__")[0];
        columns["rank"] = $(this).attr("id").split("__")[1];
        columns["test_entry_id"] = "{{ parent.id }}";
        columns["word_id"] = $(this).attr( "name" ) == "undefined" ? "" : $(this).attr( "name" );
        columns["word_value"] = $(this).val();
        args.columns = columns;

        // refresh with updated information
        if( ajax_push( "{{ widget.subject }}", "edit", args ) ) {
          slot_refresh( {{ slot }} );
        }
      } );// end text input change

      $( "#{{ widget.full }}__entry_table" ).find( 'input:radio[value="accept"]' ).change(
        function() {
        configure_ui();
      } ); // end radio input change

    } );
  </script>

{% endblock javascript %}

{% block widget %}

  <div class="spacer">

  <table id="{{ widget.full }}__entry_table"
         border="1">

    <thead>
      <tr style="height:40px">
        <th>Entry #</th>
        <th colspan="2">{{ user_1 }}</th>
        <th colspan="2">{{ user_2 }}</th>
      </tr>
    </thead>

    <tbody>
    {% for entry in entry_data %}
      <tr>
        <td class="heading" style="text-align:center">{{ entry.rank }}</td>
        {% set value_1 = '' %}
        {% set value_2 = '' %}
        {% if entry.word_id_1 is defined %}
          {% set value_1 = entry.word_1 %}  
        {% endif %}
        {% if entry.word_id_2 is defined %}
          {% set value_2 = entry.word_2 %}
        {% endif %}
        <td><input id="{{ entry.id_1 }}__{{ entry.rank }}__1"
                   type="text"
                   style="width:20%"
                   name={{ entry.word_id_1 ? entry.word_id_1 : 'undefined' }}
                   value={{ value_1 }}>
        </td>
        <td><input id="{{ entry.id_1 }}__Accept"
                   type="radio"
                   value="accept">
                   <label for="{{ entry.id_1 }}__Accept">Accept</label>
        </td>
        <td><input id="{{ entry.id_2 }}__{{ entry.rank }}__2"
                   type="text"
                   style="width:20%"
                   name={{ entry.word_id_2 ? entry.word_id_2 : 'undefined' }}
                   value={{ value_2 }}></td>
        <td><input id="{{ entry.id_2 }}__Accept"
                   type="radio"
                   value="accept">
                   <label for="{{ entry.id_2 }}__Accept">Accept</label>
        </td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

{% endblock widget %}

